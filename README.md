# Event Manager

## Цель

Разработать Backend-сервис, который позволяет автоматизировать процесс отслеживания актуальных мероприятий в городе

## Описание

Проект построен на использовании нескольких структур. Существуют пользователи, 
правительственные структуры (например, минестерство спорта), события, подписки на государственные структуры и события.
Подписка на событие означает, что пользователь будет получать уведомления на электронную почту за 5 часов, за сутки
и за неделю до события, при обновлении адреса или времени проведения, а также при отмене события. Подписка
на государственную структуру означает, что пользователь будет получать уведомления обо всех события данной
госдарственной структуры. Существует два вида пользователей: сотрудник правительственной структуры и обычный пользователь. 
Разница между этими типами пользователей в том, что сотрудник правительсвенной структуры может создавать, 
обновлять и удалять события и правительственные структуры, а обычный пользователь нет.
Авторизация построена на JWT-токенах

## Стек

* Python
* Asyncio
* FastAPI
* SQLModel
* Celery
* PostgreSQL
* Redis

<details>
<summary>А также</summary>
  
   * aiosmtplib
   * asyncpg
   * gunicorn
   * uvicorn
   * mypy
   * fastapi-filter
   * fastapi-jwt-auth
  
</details>

## Запуск

### With Docker
1) Склонировать проект
```
git clone https://github.com/hisoakende/event_manager.git
```
2) Собрать проект
```
docker-compose build
```

3) Запустить проект
```
docker-compose up
```

### Without Docker
1) Установить PostgreSQL:15.2 и Redis:7.0.3
2) Создать и активировать виртуальное окружение
3) Склонировать проект
```
git clone https://github.com/hisoakende/event_manager.git
```
4) Установить зависимости
```
pip install --no-cache-dir -r requirements.txt
```
5) Определить переменные окружения, описанные в config модулях проекта
6) Запустить celery
```
celery -A src.notifications.celery_ worker --loglevel=INFO -B --pool=solo 
```
7) Запустить сервер
```
gunicorn src.main:app --workers 7 --worker-class uvicorn.workers.UvicornWorker --bind 0.0.0.0:80
```

## Тестирование

Тестирование приложения возможно при сборке без Docker. Для тестирования необходимо определить переменные окружения
всего проекта и модуля config пакета tests. Также необходимо создать отдельную базу данных. Для запуска:
```
python3 -m tests.runner
```
Покрытие тестами составляет 95 процентов